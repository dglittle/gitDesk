{% extends 'base.html' %}

{% block title %}gitDesk - Add Repo{% endblock %}

{% block body %}

<h1>Your GitHub Repos</h1>	
	<article class="oMsg oMsgInfo"><a href="#" class="oBtnCloseSmall"></a>
	Linking a GitHub repository in gitDesk allows you to <strong>post a job automatically from within GitHub!</strong>
	Any time you create a new issue in a linked repo, all you have to do is add some markdown anywhere within the issue, and a job will be posted to oDesk automatically.</p>
	<strong>Markdown options:</strong>
	<ul><li>oDesk Bounty: $X.XX&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;<span class="oSupportInfo">(required) If this line is present, a job will be posted. All other parameters are optional</span></li>
		<li>(coming soon, required skills and custom job questions)</li>
	</ul></br>
	<a href="#gh_screenshot" data-toggle="modal">Here's how it looks in GitHub</a>
	</article></br>
<table class="table table-striped table-hover">
	<tr>
		<th>Repo Name</th>
		<th>Status</th>
	</tr>
	{% for r in repos %}
	<tr>
		<td><a href="{{r.html_url}}">{{r.name}}</a></td>
		<td>{% if r.is_linked %}
			Linked to {{r.team_name}}&nbsp;&nbsp;<a href="./api/unlinkrepo?repo={{r.name}}" ><small>unlink</small></a>
			{% else %}
			Not Linked&nbsp;&nbsp;
			{% if teams|length > 1 %}
				<div class="dropdown" style="display: inline;">
					<a class="dropdown-toggle" data-toggle="dropdown" href="#"><small>link repo</small></a>
					<ul class="dropdown-menu" role="menu" aria-labelledby="dLabel" style="width: 300px;">
						{% for t in teams %}
							<li><small><a href="./api/linkrepo?repo={{r.name}}&githubuserid={{githubuserid}}&team={{t.team__reference}}" >
								{{t.company__name}}&nbsp;&gt;&nbsp;{{t.team__name}}</a></small></li>
						{% endfor %}
					</ul>
				</div>
			{% else %}
				{% for t in teams %}
				<a href="./api/linkrepo?repo={{r.name}}&githubuserid={{githubuserid}}&team={{t.team__reference}}"><small>link repo</small></a>
				{% endfor %}
			{% endif %}
			{% endif %}
		</td>
	</tr>
	{% endfor %}
</table>

<div class="modal hide fade" id="gh_screenshot" style="width: 900px; margin-left: -452px; margin-top: 100px; max-height: 800px;">
  <div class="modal-header">
    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
    <h1>Here is how you post a job from within GitHub</h1>
  </div>
  <div class="modal-body">
	<p>First, link a repo to oDesk. Then create a new issue, add the following line (the syntax must match <strong>exactly</strong>, at least until we make it less fragile...). A job will be posted on oDesk automatically!</p>
	<img src="../img/ghscreenshot.jpeg"></br></br>
	<button class="oBtn oBtnPrimary oBtnLarge" data-dismiss="modal" style="margin-left: 400px;">Got It!</button>	
  </div>

</div>


{% endblock body%}


<input type="hidden" name="team" id="team" value="">
